import xlwt

excelfile = xlwt.Workbook()
sheet1 = excelfile.add_sheet('Container 1')
sheet2 = excelfile.add_sheet('Container 2')
sheet3 = excelfile.add_sheet('Container 3')
sheet4 = excelfile.add_sheet('Container 4')

sheet = [sheet1, sheet2, sheet3, sheet4]
sheet1.write(0, 0, "(Y,Z)")
sheet2.write(0, 0, "(Y,Z)")
sheet3.write(0, 0, "(Y,Z)")
sheet4.write(0, 0, "(Y,Z)")

for i in range(1, 74):
    sheet1.write(0, i, i)
    sheet1.write(i, 0, i)
    sheet2.write(0, i, i)
    sheet2.write(i, 0, i)
    sheet3.write(0, i, i)
    sheet3.write(i, 0, i)
    sheet4.write(0, i, i)
    sheet4.write(i, 0, i)

container3_Y = [
    0, 50, 183, 315, 448, 580, 713, 845, 978, 1110, 1243, 1375, 1508, 1640, 1773, 1905, 2038, 2170, 2303, 2435, 2568,
    2700, 2833, 2965, 3098, 3230, 3363, 3495, 3628, 3760, 3893, 4025, 4158, 4290, 4423, 4555, 4688, 4820, 4953, 5085,
    5218, 5350, 5483, 5615, 5748, 5880, 6013, 6145, 6278, 6410, 6543, 6675, 6808, 6940, 7073, 7205, 7338, 7470, 7603,
    7735, 7868, 8000, 8133
]

container3_Y_fixed = [
    0, 35, 168, 300, 433, 565, 698, 830, 963, 1095, 1228, 1360, 1493, 1625, 1758, 1890, 2023, 2155, 2288, 2420, 2553,
    2685, 2818, 2950, 3083, 3215, 3348, 3480, 3613, 3745, 3878, 4010, 4143, 4275, 4408, 4540, 4673, 4805, 4938, 5070,
    5203, 5335, 5468, 5600, 5733, 5865, 5998, 6130, 6263, 6395, 6528, 6660, 6793, 6925, 7058, 7190, 7323, 7455, 7588,
    7720, 7853, 7985, 8118, 8250, 8383, 8515, 8648, 8780, 8913, 9045, 9178, 9310, 9443, 9575, 9708
]

container3_Z = [
    0, 10, 974, 1135, 1295, 1456, 1616, 1777, 1938, 2098, 2259, 2420, 2580, 2741, 2902, 3062, 3223, 3384, 3544, 3705,
    3866, 4026, 4187, 4348, 4508, 4669, 4829, 4990, 5151, 5311, 5472, 5633, 5793, 5954, 6115, 6275, 6436, 6597, 6757,
    6918, 7079, 7239, 7400, 7561, 7721, 7882, 8042, 8203, 8364, 8524, 8685, 8846, 9006, 9167, 9328, 9488, 9649, 9810,
    9970, 10131, 10292, 10452, 10613, 10773, 10934, 11095, 11255, 11416, 11577, 11737, 11898, 12059, 12219, 12380
]

container2_Y = [
    0, 120, 253, 385, 518, 650, 783, 915, 1048, 1180, 1313, 1445, 1578, 1710, 1843, 1975, 2108, 2240, 2373, 2505, 2638,
    2770, 2903, 3035, 3168, 3300, 3433, 3565, 3698, 3830, 3963, 4095, 4228, 4360, 4493, 4625, 4758, 4890, 5023, 5155,
    5288, 5420, 5553, 5685, 5818, 5950, 6083, 6215, 6348, 6480, 6613, 6745, 6878, 7010, 7143, 7275, 7408, 7540, 7673,
    7805, 7938, 8070, 8203
]

container2_Y_fixed = [
    0, 70, 203, 335, 468, 600, 733, 865, 998, 1130, 1263, 1395, 1528, 1660, 1793, 1925, 2058, 2190, 2323, 2455, 2588,
    2720, 2853, 2985, 3118, 3250, 3383, 3515, 3648, 3780, 3913, 4045, 4178, 4310, 4443, 4575, 4708, 4840, 4973, 5105,
    5238, 5370, 5503, 5635, 5768, 5900, 6033, 6165, 6298, 6430, 6563, 6695, 6828, 6960, 7093, 7225, 7358, 7490, 7623,
    7755, 7888, 8020, 8153
]

container2_Z = [
    0, 0, 964, 1125, 1285, 1446, 1606, 1767, 1928, 2088, 2249, 2410, 2570, 2731, 2892, 3052, 3213, 3374, 3534, 3695,
    3856, 4016, 4177, 4338, 4498, 4659, 4819, 4980, 5141, 5301, 5462, 5623, 5783, 5944, 6105, 6265, 6426, 6587, 6747,
    6908, 7069, 7229, 7390, 7551, 7711, 7872, 8032, 8193, 8354, 8514, 8675, 8836, 8996, 9157, 9318, 9478, 9639, 9800,
    9960, 10121, 10282, 10442, 10603, 10763, 10924, 11085, 11245, 11406, 11567, 11727, 11888, 12049, 12209, 12385
]


def get_container4_Y(Y, Z):
    if Y == 0 or Z == 0:
        return 0
    if Z != 1:
        Z = Z + 5
    data_y1 = 0.0
    data_yn = 0.0
    data_y1 = -0.3947 * Z + 500
    data_yn = data_y1 + 132.5 * (Y - 1)
    return int(data_yn)


container4_Z = [
    0, 20, 984, 1145, 1305, 1466, 1626, 1787, 1948, 2108, 2269, 2430, 2590, 2751, 2912, 3072, 3233, 3394, 3554, 3715,
    3876, 4036, 4197, 4358, 4518, 4679, 4839, 5000, 5161, 5321, 5482, 5643, 5803, 5964, 6125, 6285, 6446, 6607, 6767,
    6928, 7089, 7249, 7410, 7571, 7731, 7892, 8052, 8213, 8374, 8534, 8695, 8856, 9016, 9177, 9338, 9498, 9659, 9820,
    9980, 10141, 10302, 10462, 10623, 10783, 10944, 11105, 11265, 11426, 11587, 11747, 11908, 12069, 12229
]
container1_Y_down = [
    0, 540, 673, 805, 938, 1070, 1203, 1335, 1468, 1600, 1733, 1865, 1998, 2130, 2263, 2395, 2528, 2660, 2793, 2925,
    3058, 3190, 3323, 3455, 3588, 3720, 3853, 3985, 4118, 4250, 4383, 4515, 4648, 4780, 4913, 5045, 5178, 5310, 5443,
    5575, 5708, 5840, 5973, 6105, 6238, 6370, 6503, 6635, 6768, 6900, 7033, 7165, 7298, 7430, 7563, 7695, 7828, 7960,
    8093, 8225, 8358, 8490, 8623, 8755, 8888, 9020, 9153, 9285, 9418, 9550, 9683, 9815, 9948, 10080
]

container1_Y_middle = [
    0, 550, 683, 815, 948, 1080, 1213, 1345, 1478, 1610, 1743, 1875, 2008, 2140, 2273, 2405, 2538, 2670, 2803, 2935,
    3068, 3200, 3333, 3465, 3598, 3730, 3863, 3995, 4128, 4260, 4393, 4525, 4658, 4790, 4923, 5055, 5188, 5320, 5453,
    5585, 5718, 5850, 5983, 6115, 6248, 6380, 6513, 6645, 6778, 6910
]
container1_Y_up = [
    0, 560, 693, 825, 958, 1090, 1223, 1355, 1488, 1620, 1753, 1885, 2018, 2150, 2283, 2415, 2548, 2680, 2813, 2945,
    3078, 3210, 3343, 3475, 3608, 3740, 3873, 4005, 4138, 4270, 4403, 4535, 4668, 4800, 4933, 5065, 5198, 5330, 5463,
    5595, 5728, 5860, 5993, 6125, 6258, 6390, 6523, 6655, 6788, 6920, 7053, 7185, 7318, 7450, 7583, 7715, 7848, 7980,
    8113, 8245, 8378, 8510, 8643, 8775, 8908, 9040, 9173, 9305
]

container1_Z = [
    0, 0, 964, 1125, 1285, 1446, 1606, 1767, 1928, 2088, 2249, 2430, 2591, 2751, 2912, 3073, 3233, 3394, 3555, 3715,
    3876, 4036, 4197, 4358, 4518, 4679, 4840, 5000, 5161, 5322, 5482, 5643, 5804, 5964, 6125, 6286, 6446, 6607, 6768,
    6928, 7089, 7249, 7410, 7575, 7735, 7896, 8056, 8216, 8377, 8537, 8697, 8858, 9018, 9178, 9339, 9499, 9659, 9820,
    9980, 10141, 10301, 10461, 10622, 10782, 10942, 11103, 11263, 11423, 11584, 11744, 11904, 12065, 12225
]


def get_container4_YZ(Y, Z):
    if Z > len(container1_Z):
        return "NULL", "NULL"
    if Z > 0 and Z < 11:
        if Y > len(container1_Y_down) - 1:
            return "NULL", "NULL"
        y_steps = container1_Y_down[Y]
        z_steps = container1_Z[Z]
    elif Z > 10 and Z < 43:
        if  Y > len(container1_Y_middle) - 1:
            return "NULL", "NULL"
        y_steps = container1_Y_middle[Y]
        z_steps = int(1.2 * (Y - 1) + container1_Z[Z])
    elif Z > 42 and Z < 72:
        if Y > len(container1_Y_up) - 1:
            return "NULL", "NULL"
        y_steps = container1_Y_up[Y]
        z_steps = int(-0.48 * (Y - 1) + container1_Z[Z])
    else:
        y_steps = 0
        z_steps = 0
    return y_steps, z_steps


def get_steps(Y, Z, container_num):
    if container_num == 1:
        y_steps, z_steps = get_container4_YZ(Y, Z)
    elif container_num == 2:
        if Y > 62:
            y_steps = 0
            z_steps = 0
            return y_steps, z_steps
        if Z > 73:
            y_steps = 0
            z_steps = 0
            return y_steps, z_steps
        if Z == 39:
            if Y > len(container2_Y_fixed):
                return "NULL", "NULL"
            y_steps = container2_Y_fixed[Y]
        else:
            if Y > len(container2_Y):
                return "NULL", "NULL"
            y_steps = container2_Y[Y]
        if Z > len(container2_Z):
            return "NULL", "NULL"
        z_steps = container2_Z[Z]
    elif container_num == 3:
        if Y > 62:
            y_steps = 0
            z_steps = 0
            return y_steps, z_steps
        if Z > 73:
            y_steps = 0
            z_steps = 0
            return y_steps, z_steps
        if Z == 39:
            if Y > len(container3_Y_fixed):
                return "NULL", "NULL"
            y_steps = container3_Y_fixed[Y] - 5
        else:
            if Y > len(container3_Y_fixed):
                return "NULL", "NULL"
            y_steps = container3_Y[Y]
        if Z > len(container3_Z):
            return "NULL", "NULL"
        z_steps = container3_Z[Z]
    elif container_num == 4:
        if Z > len(container4_Z) - 1:
            return "NULL", "NULL"
        y_steps = get_container4_Y(Y, Z)
        z_steps = container4_Z[Z]
    return y_steps, z_steps


if __name__ == "__main__":
    y_steps = []
    z_steps = []
    # for Y in range(1,74):
    #     for Z in range(1,74):
    #         ys, zs = get_steps(Y, Z, 1)
    #         y_steps.append(ys)
    #         z_steps.append(zs)
    # print y_steps
    # print z_steps
    for container_num in range(1, 5):
        for Y in range(1, 74):
            for Z in range(1, 74):
                ys, zs = get_steps(Y, Z, container_num)
                sheet[container_num - 1].write(Z, Y, "({},{})".format(ys, zs))

    excelfile.save("/Users/xiaoxiami/Desktop/position.xls")
